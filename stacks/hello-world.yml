---
- name: Deploy the diadoc-notifications stack
  docker_stack:
    name: hello-world
    resolve_image: never
    with_registry_auth: true
    compose:
      - version: "3.8"
        x-deploy-options: &deploy
          update_config:
            failure_action: rollback

        networks:
          cloudflarenet:
            external: true

        services:
          backend:
            image: ghcr.io/nkiryanov/hello-world
            deploy: *deploy
            networks:
              - cloudflarenet
