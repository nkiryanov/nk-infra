---
- name: Create databases
  community.postgresql.postgresql_db:
    name: "{{ secrets.app.postgresql.database }}"

- name: Create app account
  community.postgresql.postgresql_user:
    name: "{{ secrets.app.postgresql.user }}"
    password: "{{ secrets.app.postgresql.password }}"

- name: Grant access to app account
  community.postgresql.postgresql_privs:
    role: "{{ secrets.app.postgresql.user }}"
    db: "{{ secrets.app.postgresql.database }}"
    privs: "ALL"
    type: "schema"
    objs: "public"
    grant_option: false
